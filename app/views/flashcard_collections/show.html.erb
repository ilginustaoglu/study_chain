<!-- Theme Switcher -->
<div class="theme-switcher">
  <span class="theme-switcher-label">Theme:</span>
  <button class="theme-toggle-button" onclick="toggleTheme()">
    <span class="theme-icon" id="themeIcon">🌙</span>
    <span id="themeText">Dark</span>
  </button>
</div>

<div class="container" style="max-width: 1000px; margin: 40px auto; padding: 20px;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <div>
      <h1 style="color: var(--text-primary); font-size: 2.5em; margin-bottom: 5px;"><%= @collection.title %></h1>
      <% if @collection.description.present? %>
        <p style="color: var(--text-secondary); font-size: 1.1em;"><%= @collection.description %></p>
      <% end %>
    </div>
    <%= link_to "← Back", flashcard_collections_path, class: "btn-back", style: "text-decoration: none; background: var(--accent-primary); color: white; padding: 10px 20px; border-radius: 5px; font-weight: bold;" %>
  </div>

  <!-- Add New Card Form -->
  <div style="background: var(--accent-primary); padding: 25px; border-radius: 10px; margin-bottom: 30px; color: white;">
    <h3 style="margin-bottom: 15px;">➕ Add New Card</h3>
    <%= form_with url: add_card_flashcard_collection_path(@collection), method: :post, local: true do %>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
        <div>
          <%= label_tag 'flashcard[front]', "Front Side *", style: "display: block; font-weight: bold; margin-bottom: 5px;" %>
          <%= text_area_tag 'flashcard[front]', nil, required: true, rows: 3, placeholder: "Question or word...", style: "width: 100%; padding: 10px; border: none; border-radius: 5px; font-size: 1em; color: #2c3e50;" %>
        </div>
        <div>
          <%= label_tag 'flashcard[back]', "Back Side *", style: "display: block; font-weight: bold; margin-bottom: 5px;" %>
          <%= text_area_tag 'flashcard[back]', nil, required: true, rows: 3, placeholder: "Answer or translation...", style: "width: 100%; padding: 10px; border: none; border-radius: 5px; font-size: 1em; color: #2c3e50;" %>
        </div>
      </div>
      <%= submit_tag "Add Card", style: "background: white; color: var(--accent-primary); padding: 12px 25px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1em;" %>
    <% end %>
  </div>

  <!-- Cards List -->
  <div style="background: var(--bg-secondary); padding: 25px; border-radius: 10px; box-shadow: var(--shadow-md);">
    <h3 style="color: var(--text-primary); margin-bottom: 20px;">Cards (<%= @flashcards.count %>)</h3>
    
    <% if @flashcards.empty? %>
      <p style="text-align: center; color: var(--text-secondary); padding: 30px;">No cards added yet. You can add cards using the form above.</p>
    <% else %>
      <div style="display: grid; gap: 15px;">
        <% @flashcards.each_with_index do |card, index| %>
          <div class="flashcard-item" style="border: 2px solid var(--border-color); border-radius: 10px; padding: 20px; position: relative; transition: all 0.3s; background: var(--bg-tertiary);" onmouseover="this.style.borderColor='var(--accent-primary)'" onmouseout="this.style.borderColor='var(--border-color)'">
            <div style="position: absolute; top: 10px; right: 10px;">
              <%= link_to "🗑️", remove_card_flashcard_collection_path(@collection, card_id: card.id), method: :delete, data: { confirm: "Are you sure you want to delete this card?" }, style: "text-decoration: none; font-size: 1.2em;" %>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
              <div>
                <div style="background: rgba(74, 144, 226, 0.1); padding: 15px; border-radius: 8px; min-height: 80px; border: 1px solid var(--accent-primary);">
                  <strong style="color: var(--accent-primary); display: block; margin-bottom: 8px;">🔵 Front Side:</strong>
                  <p style="color: var(--text-primary); margin: 0; white-space: pre-wrap;"><%= card.front %></p>
                </div>
              </div>
              <div>
                <div style="background: rgba(74, 144, 226, 0.05); padding: 15px; border-radius: 8px; min-height: 80px; border: 1px solid var(--border-color);">
                  <strong style="color: var(--text-secondary); display: block; margin-bottom: 8px;">🔴 Back Side:</strong>
                  <p style="color: var(--text-primary); margin: 0; white-space: pre-wrap;"><%= card.back %></p>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>

<script>
  // Theme switcher functionality
  function getTheme() {
    return localStorage.getItem('theme') || 'light';
  }

  function setTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
    updateThemeButton(theme);
  }

  function updateThemeButton(theme) {
    const themeIcon = document.getElementById('themeIcon');
    const themeText = document.getElementById('themeText');
    
    if (theme === 'dark') {
      themeIcon.innerHTML = '<i class="fa-solid fa-sun"></i>';
      themeText.textContent = 'Light';
    } else {
      themeIcon.innerHTML = '<i class="fa-solid fa-moon"></i>';
      themeText.textContent = 'Dark';
    }
  }

  function toggleTheme() {
    const currentTheme = getTheme();
    const newTheme = currentTheme === 'light' ? 'dark' : 'light';
    setTheme(newTheme);
  }

  (function initTheme() {
    const savedTheme = getTheme();
    setTheme(savedTheme);
  })();
</script>

<style>
  .flashcard-item:hover {
    box-shadow: var(--shadow-md);
  }
</style>
